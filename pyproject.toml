[tool.ruff]
# 目标Python版本
target-version = "py39"

# 每行最大字符数
line-length = 100

# 启用的规则集
select = [
    "E",    # pycodestyle errors
    "W",    # pycodestyle warnings
    "F",    # pyflakes
    "I",    # isort (导入排序)
    "B",    # flake8-bugbear (常见bug)
    "C4",   # flake8-comprehensions (列表推导优化)
    "SIM",  # flake8-simplify (代码简化)
    "N",    # pep8-naming (命名规范)
    "UP",   # pyupgrade (Python版本升级建议)
    "RUF",  # Ruff特定规则
]

# 忽略的规则
ignore = [
    "E501",   # 行太长（已在line-length设置）
    "B008",   # 函数调用中的默认参数
    "C901",   # 复杂度过高（可根据需要调整）
    "N802",   # 函数名应为小写（Flask路由可能需要）
    "N806",   # 变量名应为小写
]

# 排除的目录和文件
exclude = [
    ".git",
    ".venv",
    "venv",
    "env",
    "__pycache__",
    "*.pyc",
    ".pytest_cache",
    "node_modules",
    "dist",
    "build",
    "*.egg-info",
    "dashboard-test*",
    "dashboard-v*",
    "memory-space-backup*",
]

# 每个文件允许的自动修复
fix = true
unfixable = []

# 显示修复的内容
show-fixes = true

[tool.ruff.format]
# 使用双引号
quote-style = "double"

# 缩进样式：空格
indent-style = "space"

# 每个缩进级别的空格数
line-ending = "auto"

# 跳过魔术方法的尾随逗号
skip-magic-trailing-comma = false

[tool.ruff.isort]
# 导入排序配置
known-first-party = ["apps", "services", "config", "database"]

# 导入分组
section-order = [
    "future",
    "standard-library", 
    "third-party",
    "first-party",
    "local-folder"
]

# 每组之间的空行数
lines-after-imports = 2

# 合并导入
combine-as-imports = true

[tool.ruff.per-file-ignores]
# 测试文件可以有更长的行
"test_*.py" = ["E501"]
# __init__.py 可以有未使用的导入
"__init__.py" = ["F401"]
# 迁移文件忽略某些规则
"**/migrations/*.py" = ["E501", "N806"]

[tool.ruff.mccabe]
# 最大复杂度
max-complexity = 15

[tool.ruff.pep8-naming]
# 允许的类名
classmethod-decorators = ["classmethod", "validator"]

