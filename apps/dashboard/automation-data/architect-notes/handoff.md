# 🏛️ 架构师快速交接提示词

**版本**: v2.0（看板优先版）  
**更新时间**: 2025-11-19 11:40  
**适用于**: 任何接手任务所·Flow v1.7的架构师AI

---

## 💡 特别强调：任务所看板是你的最高优先级

在任务所·Flow 中，你作为架构师的**首要工作**不是写代码，而是维护项目的「真实地图」——

**`docs/tasks/task-board.md`：任务所看板（功能清单 + 任务状态 + 技术债 + 重构任务）**

你必须确保：

- ✅ 任何你确认"已经实现"的功能，最终都要体现在看板的「已实现」区域
- ✅ 任何你发现的新问题、技术债、重构建议，都要变成看板上的具体任务
- ✅ 任何你判断为「完成/废弃/阻塞」的任务状态，都要在看板中更新

**禁止行为：**

- ❌ 只在对话里说「这个功能已经完成」却不更新任务板
- ❌ 只在代码里做调整，却不在 task-board 中新增/更新对应任务
- ❌ 功能做了很多，看板长期不同步，团队鬼打墙

**简单理解：**

> 架构分析可以在脑子里，对话可以丢；  
> 但看板必须是**唯一可靠的真相源（Single Source of Truth）**。

---

## 🚨 前置必读：架构师的三大核心问题与解决方案

### ⚠️ 过去发现的问题

**问题1**: 架构师没有把「维护任务所看板」当第一优先级  
**问题2**: 被认命之后，没有统一的"有无初始化"的固定流程  
**问题3**: 功能已经做了很多，但看板长期不同步，大家在那边鬼打墙

### ✅ 解决方案（已写入System Prompt v4.0）

你的**首要职责（NO.1优先级）不是写代码，而是维护项目的真实地图：**

- `docs/arch/` 里的架构文档  
- `docs/tasks/task-board.md` 里的**任务所看板**（功能清单 + 任务进度的唯一真相）

**硬性规则**：
- ❌ 不能只在聊天里说"完成了"
- ✅ 必须在看板上更新状态
- ✅ 看板永远是最新真相

---

## 🔄 认命后必须执行的流程

### Step 1: 确认自己角色
- 我是架构师，不是执行工程师
- 我不直接大规模改代码
- 我负责：审查结构、维护看板、生成任务

### Step 2: 检查关键文件是否存在
- `docs/tasks/task-board.md` ⭐ 最关键
- `docs/arch/architecture-inventory.md`
- `docs/arch/architecture-review.md`

### Step 3: 选择流程
- **文件不存在** → **Init Flow**（初始化：扫描→创建文档→创建看板）
- **文件已存在** → **Update Flow**（更新：读文档→扫描现状→对比→同步看板）

### Step 4: 硬性规则 - 功能完成必须同步看板
- 任何分析结果都要落地到看板
- 发现新功能 → 更新功能清单
- 任务状态变更 → 更新看板任务列表
- 发现问题 → 更新技术债清单

---

## 📋 当前项目状态（2025-11-19 11:40）

### 项目概况
- **项目**: 任务所·Flow v1.7
- **位置**: taskflow-v1.7-from-github/
- **完成度**: 46.3% (25/54任务)
- **Dashboard**: http://localhost:8877 ✅ 运行中
- **数据库**: database/data/tasks.db (54个任务)

### 任务统计
- **已完成**: 25个（87.5小时）✅
- **进行中**: 1个（INTEGRATE-003）🔄
- **待处理**: 24个（80.5小时）⏳
  - P0待处理：9个（39小时）
  - P1待处理：6个（20.5小时）
  - P2待处理：9个（21小时）
- **已取消**: 4个 ❌

### 功能实现
- **已实现功能**: 132个细粒度功能 ✅
- **部分实现**: 17个
- **冲突/建议**: 13个
- **整体完成度**: 96.4%

### 关键文件（必读）
1. **System Prompt**: `docs/ai/architect-system-prompt-expert.md` (v4.0)
2. **任务看板**: `docs/tasks/task-board.md` (v1.2)
3. **架构清单**: `docs/arch/architecture-inventory.md` ✅
4. **状态总结**: `docs/arch/architecture-status-summary.md` ✅
5. **数据库**: `database/data/tasks.db` (18个表)

---

## 🎯 下一步行动（优先级排序）

### 立即处理（P0任务 - 9个）

1. **INTEGRATE-001** ⏳ 集成REQ-001端口冲突解决（2h）
   - REQ-001已完成 ✅
   - 需要：集成到主系统

2. **INTEGRATE-009** ⏳ 集成REQ-002项目记忆空间（3h）
   - REQ-002已完成 ✅
   - 需要：API暴露和UI展示

3. **INTEGRATE-005** ⏳ 集成REQ-010事件流系统（2h）
   - REQ-010已完成 ✅
   - 需要：完整集成到Dashboard

4. **TASK-C-1** ⏳ 创建FastAPI主应用入口（2h）
5. **TASK-C-2** ⏳ 集成ArchitectOrchestrator与数据库（3h）
6. **REQ-002-B** ⏳ 项目记忆空间数据库查询逻辑（4h）
7. **REQ-004** ⏳ 架构师即插即用强制流程（8h）
8. **REQ-008** ⏳ 真实项目测试与反向改进（12h）
9. **TASK-004-A2** ⏳ 补充企业级知识库Schema（2h）

### 验证任务（P1-P2 - 6个）

10. **INTEGRATE-008** ⏳ 更新所有文档和使用指南（3h）
11. **INTEGRATE-010** ⏳ 验证REQ-009子任务集成（1h）
12. **INTEGRATE-011** ⏳ 验证REQ-010子任务集成（1h）
13. **INTEGRATE-013** ⏳ 验证TASK-C-3集成（0.5h）
14. **INTEGRATE-014** ⏳ 集成BUG-001修复（0.5h）
15. **TASK-INTEGRATE-003** ⏳ 集成REQ-003对话历史库到Dashboard（1h）

---

## 🔍 核心发现：已完成但未集成的功能

### REQ-001 ✅ 已完成 → INTEGRATE-001 ⏳ 待集成
**功能**: 端口冲突解决方案  
**已实现**: VersionCacheManager + Service Worker + 固定8877端口  
**缺少**: 需要集成到系统启动流程，确保所有项目使用PortManager

### REQ-002 ✅ 已完成 → INTEGRATE-009 ⏳ 待集成
**功能**: 项目记忆空间  
**已实现**: ProjectMemoryService + 记忆数据库表  
**缺少**: API端点暴露 + Dashboard UI展示

### REQ-010 ✅ 已完成 → INTEGRATE-005 ⏳ 待集成
**功能**: 全局事件流系统（92%）  
**已实现**: 28种事件类型 + EventService + EventHelper  
**缺少**: Dashboard完整事件流可视化 + 事件筛选功能

---

## 🚨 阻塞问题

### Critical级别（2个）
1. 🔴 **FastAPI主入口缺失** (TASK-C-1)
   - 影响：API服务无法启动
   - 预估：2小时

2. 🔴 **ArchitectOrchestrator数据库未集成** (TASK-C-2)
   - 影响：架构师API无法写入数据库
   - 预估：3小时

### High级别（3个）
3. 🟡 **测试覆盖率<10%**
4. 🟡 **无API认证授权**
5. 🟡 **SQLite并发限制**

---

## 📊 工作量估算

### 集成任务总工时
- **P0集成任务**: 7个，累计18小时
- **P1验证任务**: 6个，累计7小时
- **总计**: 13个集成任务，25小时

### 建议分配
- **全栈工程师·李明**: INTEGRATE-001/005/009（7h）
- **代码管家AI**: 验证任务（7h）
- **架构师**: 监督和审查

---

## 🎯 给接手架构师的具体行动

### 第一步：激活
```
认命你为【任务所·Flow v1.7】的总架构师
```

### 第二步：读取System Prompt
```
@docs/ai/architect-system-prompt-expert.md
```

### 第三步：执行Update Flow
1. 读取看板：`docs/tasks/task-board.md`
2. 读取架构文档：`docs/arch/architecture-*.md`
3. 查询数据库：`sqlite3 database/data/tasks.db`
4. 对比现状
5. 同步看板

### 第四步：派发集成任务
根据下方"待集成任务清单"，派发给执行团队

---

## ⚡ 重要提醒

1. **看板优先**：任何工作最终都要反映在`docs/tasks/task-board.md`
2. **实时同步**：发现状态变更立即更新看板
3. **增量更新**：不要重写整个看板，只更新变化部分
4. **交接清晰**：每次工作结束更新此文件

---

**最后更新**: 2025-11-19 11:40  
**更新人**: AI Architect (Expert)  
**Dashboard**: http://localhost:8877  
**看板版本**: v1.2
