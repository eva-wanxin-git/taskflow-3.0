# ä»»åŠ¡çœ‹æ¿è‡ªåŠ¨åŒæ­¥ç³»ç»Ÿ

## ğŸ“‹ æ¦‚è¿°

è‡ªåŠ¨åŒ–çœ‹æ¿åˆ·æ–°ç³»ç»Ÿï¼Œå®šæœŸä»äº‹ä»¶æµå’Œæ•°æ®åº“æ‹‰å–æœ€æ–°çŠ¶æ€ï¼Œè‡ªåŠ¨æ›´æ–° `docs/tasks/task-board.md`ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

1. **äº‹ä»¶æµç›‘å¬**
   - ç›‘å¬ `task.created`ã€`task.completed`ã€`task.status_changed` äº‹ä»¶
   - ä»å…¨å±€äº‹ä»¶æµè·å–ä»»åŠ¡çŠ¶æ€å˜æ›´

2. **æ•°æ®åº“åŒæ­¥**
   - ä» SQLite æ•°æ®åº“æŸ¥è¯¢ä»»åŠ¡æœ€æ–°çŠ¶æ€
   - æ”¯æŒå¤šç»´åº¦æŸ¥è¯¢ï¼ˆçŠ¶æ€ã€ä¼˜å…ˆçº§ã€æ‰§è¡Œäººç­‰ï¼‰

3. **æ™ºèƒ½å¯¹æ¯”**
   - å¯¹æ¯”çœ‹æ¿å†…å®¹å’Œæ•°æ®åº“å®é™…çŠ¶æ€
   - æ£€æµ‹ä¸ä¸€è‡´å¹¶ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š

4. **è‡ªåŠ¨æ›´æ–°**
   - ä»»åŠ¡å®Œæˆ â†’ æ ‡è®°âœ…å¹¶ç§»åŠ¨åˆ°å·²å®ŒæˆåŒº
   - ä»»åŠ¡å¼€å§‹ â†’ æ ‡è®°ğŸ”„å¹¶ç§»åŠ¨åˆ°è¿›è¡Œä¸­åŒº
   - æ–°ä»»åŠ¡åˆ›å»º â†’ æ·»åŠ åˆ°å¾…å¤„ç†åŒº
   - è‡ªåŠ¨æ›´æ–°ç»Ÿè®¡æ•°æ®å’Œè¿›åº¦æ¡

5. **å®‰å…¨æœºåˆ¶**
   - æ›´æ–°å‰è‡ªåŠ¨å¤‡ä»½çœ‹æ¿
   - æ–‡ä»¶é”æ£€æµ‹ï¼ˆé¿å…ç¼–è¾‘å†²çªï¼‰
   - è¯¦ç»†çš„æ›´æ–°æ—¥å¿—

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹å¼1: æ‰‹åŠ¨è§¦å‘

```bash
# è¿è¡Œä¸€æ¬¡åŒæ­¥
python services/task_board_auto_sync.py
```

### æ–¹å¼2: å®šæ—¶ä»»åŠ¡ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨å®šæ—¶è°ƒåº¦å™¨ï¼ˆæ¯10åˆ†é’Ÿè‡ªåŠ¨åŒæ­¥ï¼‰
python services/task_board_scheduler.py
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
======================================================================
ğŸš€ ä»»åŠ¡çœ‹æ¿è‡ªåŠ¨åŒæ­¥è°ƒåº¦å™¨
======================================================================
å¯åŠ¨æ—¶é—´: 2025-11-19 14:30:00
åŒæ­¥é—´éš”: æ¯ 10 åˆ†é’Ÿ
çœ‹æ¿è·¯å¾„: /path/to/docs/tasks/task-board.md
======================================================================

ğŸ’¡ æç¤º:
  - æŒ‰ Ctrl+C åœæ­¢æœåŠ¡
  - è„šæœ¬ä¼šè‡ªåŠ¨å¤‡ä»½çœ‹æ¿
  - åŒæ­¥æ—¥å¿—ä¿å­˜åœ¨ docs/tasks/sync_log.json

ğŸ”„ æ‰§è¡Œé¦–æ¬¡åŒæ­¥...
```

### æ–¹å¼3: APIè§¦å‘

```bash
# è§¦å‘åŒæ­¥
curl -X POST http://localhost:8870/api/task-board/sync

# æŸ¥çœ‹åŒæ­¥çŠ¶æ€
curl http://localhost:8870/api/task-board/status

# æ£€æŸ¥ä¸ä¸€è‡´
curl http://localhost:8870/api/task-board/inconsistencies
```

## ğŸ“Š APIç«¯ç‚¹

### POST /api/task-board/sync

è§¦å‘çœ‹æ¿åŒæ­¥

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "message": "æˆåŠŸåŒæ­¥ 3 ä¸ªä»»åŠ¡",
  "details": {
    "inconsistencies": 3,
    "updated": 2,
    "added": 1,
    "backup": "/path/to/backup/task-board_20251119_143000.md"
  }
}
```

### GET /api/task-board/status

è·å–åŒæ­¥çŠ¶æ€

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "board_path": "/path/to/docs/tasks/task-board.md",
  "board_exists": true,
  "last_sync": {
    "timestamp": "2025-11-19T14:30:00",
    "success": true,
    "inconsistencies_found": 3,
    "tasks_updated": 2,
    "tasks_added": 1
  },
  "backup_dir": "/path/to/docs/tasks/backups"
}
```

### GET /api/task-board/inconsistencies

æ£€æŸ¥çœ‹æ¿ä¸æ•°æ®åº“çš„ä¸ä¸€è‡´

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "count": 2,
  "inconsistencies": [
    {
      "task_id": "REQ-001",
      "title": "ç«¯å£å†²çªè§£å†³æ–¹æ¡ˆ",
      "db_status": "completed",
      "board_status": "in_progress",
      "action": "update_status",
      "line_number": 125
    },
    {
      "task_id": "TASK-AUTO-001",
      "title": "å®ç°è‡ªåŠ¨åŒ–çœ‹æ¿åˆ·æ–°è„šæœ¬",
      "db_status": "in_progress",
      "board_status": null,
      "action": "add_to_board",
      "priority": "P1",
      "estimated_hours": 2.0
    }
  ]
}
```

## ğŸ”§ é…ç½®è¯´æ˜

### æ–‡ä»¶è·¯å¾„

- **çœ‹æ¿æ–‡ä»¶**: `docs/tasks/task-board.md`
- **æ•°æ®åº“**: `database/data/tasks.db`
- **å¤‡ä»½ç›®å½•**: `docs/tasks/backups/`
- **åŒæ­¥æ—¥å¿—**: `docs/tasks/sync_log.json`

### çŠ¶æ€æ˜ å°„

| æ•°æ®åº“çŠ¶æ€ | çœ‹æ¿Emoji | è¯´æ˜ |
|-----------|----------|------|
| pending | â³ | å¾…å¤„ç† |
| in_progress | ğŸ”„ | è¿›è¡Œä¸­ |
| completed | âœ… | å·²å®Œæˆ |
| cancelled | âŒ | å·²å–æ¶ˆ |
| blocked | ğŸš« | å·²é˜»å¡ |

## ğŸ“ åŒæ­¥æ—¥å¿—

åŒæ­¥æ—¥å¿—ä¿å­˜åœ¨ `docs/tasks/sync_log.json`ï¼ŒåŒ…å«ï¼š

```json
{
  "timestamp": "2025-11-19T14:30:00",
  "success": true,
  "inconsistencies_found": 3,
  "inconsistencies": [...],
  "tasks_updated": 2,
  "tasks_added": 1
}
```

æœ€å¤šä¿ç•™æœ€è¿‘100æ¡æ—¥å¿—ã€‚

## ğŸ”’ å®‰å…¨æœºåˆ¶

### 1. è‡ªåŠ¨å¤‡ä»½

æ¯æ¬¡æ›´æ–°å‰è‡ªåŠ¨å¤‡ä»½çœ‹æ¿æ–‡ä»¶åˆ° `docs/tasks/backups/`

å¤‡ä»½æ–‡ä»¶å‘½åæ ¼å¼: `task-board_YYYYMMDD_HHMMSS.md`

### 2. æ–‡ä»¶é”æ£€æµ‹

- æ£€æŸ¥ `.lock` æ–‡ä»¶ï¼Œé¿å…ç¼–è¾‘å†²çª
- é”æ–‡ä»¶è¶…è¿‡5åˆ†é’Ÿè‡ªåŠ¨æ¸…é™¤
- å¦‚æœæ£€æµ‹åˆ°é”å®šï¼Œè·³è¿‡æœ¬æ¬¡åŒæ­¥

### 3. æ ¼å¼ä¿æŠ¤

- åªæ›´æ–°ä»»åŠ¡çŠ¶æ€å’Œç»Ÿè®¡æ•°æ®
- ä¸æ”¹å˜çœ‹æ¿çš„æ•´ä½“ç»“æ„å’Œæ ¼å¼
- ä¿ç•™æ‰€æœ‰æ³¨é‡Šå’Œè¯´æ˜æ–‡å­—

## ğŸ¨ çœ‹æ¿æ ¼å¼è¦æ±‚

è„šæœ¬ä¾èµ–ä»¥ä¸‹çœ‹æ¿æ ¼å¼ï¼š

### ä»»åŠ¡è¡Œæ ¼å¼

```markdown
**TASK-ID** âœ… ä»»åŠ¡æ ‡é¢˜ (2.0h)
   - æ‰§è¡Œè€…: fullstack-engineer
```

### åŒºåŸŸæ ‡è®°

- å·²å®Œæˆ: `### âœ… å·²å®Œæˆä»»åŠ¡`
- è¿›è¡Œä¸­: `#### ğŸ”„ è¿›è¡Œä¸­`
- å¾…å¤„ç†: `#### â³ P0ä»»åŠ¡æ¸…å•`
- å·²å–æ¶ˆ: `### âŒ å·²å–æ¶ˆä»»åŠ¡`

### ç»Ÿè®¡æ•°æ®

```markdown
- **æ€»ä»»åŠ¡**: 56ä¸ª
- **å·²å®Œæˆ**: 29ä¸ª (51.8%) âœ…
- **è¿›è¡Œä¸­**: 1ä¸ª ğŸ”„
- **å¾…å¤„ç†**: 22ä¸ª â³
```

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: åŒæ­¥å¤±è´¥

**ç—‡çŠ¶**: è„šæœ¬è¿è¡Œä½†æ²¡æœ‰æ›´æ–°çœ‹æ¿

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å­˜åœ¨: `ls -la database/data/tasks.db`
2. æ£€æŸ¥çœ‹æ¿æ–‡ä»¶æ˜¯å¦å­˜åœ¨: `ls -la docs/tasks/task-board.md`
3. æŸ¥çœ‹åŒæ­¥æ—¥å¿—: `cat docs/tasks/sync_log.json`
4. æ£€æŸ¥æ–‡ä»¶æƒé™

### é—®é¢˜2: æ ¼å¼é”™è¯¯

**ç—‡çŠ¶**: çœ‹æ¿æ ¼å¼è¢«ç ´å

**è§£å†³æ–¹æ¡ˆ**:
1. ä»å¤‡ä»½æ¢å¤: `cp docs/tasks/backups/task-board_*.md docs/tasks/task-board.md`
2. æ£€æŸ¥çœ‹æ¿æ ¼å¼æ˜¯å¦ç¬¦åˆè¦æ±‚
3. æ‰‹åŠ¨ä¿®å¤æ ¼å¼åé‡æ–°è¿è¡Œ

### é—®é¢˜3: æ–‡ä»¶è¢«é”å®š

**ç—‡çŠ¶**: æç¤º"çœ‹æ¿æ–‡ä»¶æ­£åœ¨è¢«ç¼–è¾‘"

**è§£å†³æ–¹æ¡ˆ**:
1. å…³é—­æ­£åœ¨ç¼–è¾‘çœ‹æ¿çš„ç¨‹åº
2. åˆ é™¤é”æ–‡ä»¶: `rm docs/tasks/task-board.md.lock`
3. é‡æ–°è¿è¡ŒåŒæ­¥

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨ SQLite ç´¢å¼•åŠ é€ŸæŸ¥è¯¢
- æ‰¹é‡å¤„ç†ä»»åŠ¡æ›´æ–°
- å¢é‡æ›´æ–°ï¼ˆåªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼‰
- å¤‡ä»½æ–‡ä»¶è‡ªåŠ¨æ¸…ç†ï¼ˆä¿ç•™æœ€è¿‘20ä¸ªï¼‰

## ğŸ”„ ä¸å…¶ä»–æœåŠ¡é›†æˆ

### ä¸äº‹ä»¶æµé›†æˆ

è„šæœ¬è¯»å– `project_events` è¡¨ï¼Œè·å–æœ€æ–°çš„ä»»åŠ¡äº‹ä»¶ï¼š

```python
from services.event_service import EventStore

event_store = EventStore(db_path="database/data/tasks.db")
events = event_store.query(category="task", limit=100)
```

### ä¸çŠ¶æ€ç®¡ç†é›†æˆ

é…åˆ `task_status_poller.py` ä½¿ç”¨ï¼Œå®ç°å®Œæ•´çš„è‡ªåŠ¨åŒ–ï¼š

1. `task_status_poller.py` - ç›‘æ§æ–‡ä»¶ç³»ç»Ÿï¼Œè‡ªåŠ¨æ›´æ–°æ•°æ®åº“
2. `task_board_auto_sync.py` - ä»æ•°æ®åº“åŒæ­¥åˆ°çœ‹æ¿

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ä»»åŠ¡çœ‹æ¿](../../docs/tasks/task-board.md)
- [äº‹ä»¶ç³»ç»Ÿæ–‡æ¡£](../../docs/features/event-system.md)
- [ä»»åŠ¡çŠ¶æ€ç›‘æ§](./task_status_poller.py)

## ğŸ¯ éªŒæ”¶æ ‡å‡†

- [x] è„šæœ¬å¯ä»¥æ­£å¸¸è¿è¡Œ
- [x] èƒ½æ£€æµ‹å‡ºçœ‹æ¿å’Œæ•°æ®åº“çš„ä¸ä¸€è‡´
- [x] èƒ½è‡ªåŠ¨æ›´æ–°çœ‹æ¿markdown
- [x] æ›´æ–°æ—¥å¿—æ¸…æ™°
- [x] ä¸ä¼šç ´åçœ‹æ¿æ ¼å¼
- [x] å¤‡ä»½æœºåˆ¶å®Œå–„
- [x] å†²çªæ£€æµ‹æœ‰æ•ˆ
- [x] APIç«¯ç‚¹å¯ç”¨

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹åŒæ­¥æ—¥å¿—: `docs/tasks/sync_log.json`
2. æŸ¥çœ‹å¤‡ä»½æ–‡ä»¶: `docs/tasks/backups/`
3. æäº¤Issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿ

---

**å¼€å‘è€…**: fullstack-engineer  
**ä»»åŠ¡ID**: TASK-AUTO-001  
**å®Œæˆæ—¶é—´**: 2025-11-19  
**ç‰ˆæœ¬**: v1.0

