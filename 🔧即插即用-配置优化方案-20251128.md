# ğŸ”§ ä»»åŠ¡æ‰€ 3.0 - å³æ’å³ç”¨é…ç½®ä¼˜åŒ–æ–¹æ¡ˆ

**åˆ›å»ºæ—¶é—´**: 2025-11-28
**ç›®æ ‡**: æ¶ˆé™¤æ‰€æœ‰ç¡¬ç¼–ç é…ç½®ï¼Œå®ç°çœŸæ­£çš„å³æ’å³ç”¨
**é¢„è®¡å·¥æ—¶**: 4å°æ—¶

---

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

å°†ä»»åŠ¡æ‰€ 3.0 ä»"éœ€è¦é…ç½®"å‡çº§åˆ°"çœŸæ­£å³æ’å³ç”¨"ï¼š

**å½“å‰çŠ¶æ€**: éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ç¡¬ç¼–ç çš„IPã€è·¯å¾„ç­‰é…ç½®
**ç›®æ ‡çŠ¶æ€**: é›¶é…ç½®å¯åŠ¨ï¼Œæ‰€æœ‰è®¾ç½®è‡ªåŠ¨æ£€æµ‹æˆ–ä»ç¯å¢ƒå˜é‡è¯»å–

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§ä¿®å¤ï¼ˆå¿…é¡»å®Œæˆï¼‰

### ä¿®å¤ 1: MCP è®°å¿†ç³»ç»Ÿåœ°å€é…ç½®åŒ–

#### é—®é¢˜æ–‡ä»¶
```
1. packages/core-domain/src/services/mcp_memory_client.py:36
2. README-å³æ’å³ç”¨.md:139
3. ğŸš€å³æ’å³ç”¨-åˆå§‹åŒ–é¡¹ç›®.sh:599
```

#### å½“å‰ä»£ç é—®é¢˜
```python
# âŒ ç¡¬ç¼–ç ç‰¹å®šIP
self.session_env = {
    "SESSION_MEMORY_API_URL": "http://13.158.83.99:4000",
    "DEFAULT_USER_ID": "taskflow",
    "DEFAULT_PLATFORM": "taskflow-system"
}
```

#### ä¿®å¤æ–¹æ¡ˆ
```python
# âœ… ä»ç¯å¢ƒå˜é‡è¯»å–ï¼Œæä¾›åˆç†é»˜è®¤å€¼
import os

self.session_env = {
    "SESSION_MEMORY_API_URL": os.getenv(
        "SESSION_MEMORY_API_URL",
        "http://localhost:4000"  # é»˜è®¤æœ¬åœ°æœåŠ¡
    ),
    "DEFAULT_USER_ID": os.getenv(
        "MCP_USER_ID",
        "taskflow"
    ),
    "DEFAULT_PLATFORM": os.getenv(
        "MCP_PLATFORM",
        "taskflow-system"
    )
}
```

#### ä¿®å¤æ­¥éª¤
1. ä¿®æ”¹ `mcp_memory_client.py`
2. æ›´æ–° `README-å³æ’å³ç”¨.md` è¯´æ˜
3. ä¿®æ”¹åˆå§‹åŒ–è„šæœ¬ç”Ÿæˆç¯å¢ƒå˜é‡æç¤º

---

### ä¿®å¤ 2: MCP è„šæœ¬è·¯å¾„é…ç½®åŒ–

#### é—®é¢˜æ–‡ä»¶
```
packages/core-domain/src/services/mcp_memory_client.py:20-22
```

#### å½“å‰ä»£ç é—®é¢˜
```python
# âŒ ç¡¬ç¼–ç å¼€å‘è€…æœ¬åœ°Macè·¯å¾„
self.ultra_memory_script = "/Users/yalinwang/Desktop/èµ„æ–™/cursorå·¥ä½œç›˜/ultra-memory-cloud-mcp/src/server.js"
self.session_memory_script = "/Users/yalinwang/Desktop/èµ„æ–™/cursorå·¥ä½œç›˜/session-memory-mcp/src/index.js"
```

#### ä¿®å¤æ–¹æ¡ˆ
```python
# âœ… å¤šçº§æŸ¥æ‰¾ç­–ç•¥
import os
from pathlib import Path

def find_mcp_script(env_var: str, default_paths: list, script_name: str) -> str:
    """
    å¤šçº§æŸ¥æ‰¾MCPè„šæœ¬:
    1. ç¯å¢ƒå˜é‡æŒ‡å®šçš„è·¯å¾„
    2. ~/.taskflow/mcp/ ç›®å½•
    3. é¡¹ç›®ç›¸å¯¹è·¯å¾„
    4. è¿”å›Noneè¡¨ç¤ºæœªå®‰è£…
    """
    # 1. ç¯å¢ƒå˜é‡
    if os.getenv(env_var):
        return os.getenv(env_var)

    # 2. æ ‡å‡†å®‰è£…ä½ç½®
    for base_path in default_paths:
        script_path = Path(base_path) / script_name
        if script_path.exists():
            return str(script_path)

    # 3. æœªæ‰¾åˆ°
    return None

# Ultra Memory Cloud MCP
self.ultra_memory_script = find_mcp_script(
    env_var="ULTRA_MEMORY_SCRIPT",
    default_paths=[
        Path.home() / ".taskflow" / "mcp" / "ultra-memory-cloud-mcp",
        Path(__file__).parent.parent.parent / "mcp" / "ultra-memory-cloud-mcp"
    ],
    script_name="src/server.js"
)

# Session Memory MCP
self.session_memory_script = find_mcp_script(
    env_var="SESSION_MEMORY_SCRIPT",
    default_paths=[
        Path.home() / ".taskflow" / "mcp" / "session-memory-mcp",
        Path(__file__).parent.parent.parent / "mcp" / "session-memory-mcp"
    ],
    script_name="src/index.js"
)

# å¯åŠ¨æ—¶æ£€æŸ¥
if not self.ultra_memory_script:
    print("âš ï¸ Ultra Memory MCP æœªå®‰è£…ï¼Œè®°å¿†åŠŸèƒ½å°†å—é™")
if not self.session_memory_script:
    print("âš ï¸ Session Memory MCP æœªå®‰è£…ï¼Œä¼šè¯åŠŸèƒ½å°†å—é™")
```

#### ä¿®å¤æ­¥éª¤
1. æ·»åŠ  `find_mcp_script()` è¾…åŠ©å‡½æ•°
2. ä¿®æ”¹MCPå®¢æˆ·ç«¯åˆå§‹åŒ–é€»è¾‘
3. æ·»åŠ MCPæœªå®‰è£…æ—¶çš„ä¼˜é›…é™çº§

---

### ä¿®å¤ 3: å‰ç«¯ API åœ°å€åŠ¨æ€åŒ–

#### é—®é¢˜æ–‡ä»¶
```
dashboard-test-8831/index.html (å¤šå¤„)
```

#### å½“å‰ä»£ç é—®é¢˜
```javascript
// âŒ ç¡¬ç¼–ç  localhost:8800
const response = await fetch('http://localhost:8800/api/engineer/events');
const response = await fetch('http://localhost:8800/api/architect/monitor');
// ... çº¦40å¤„ç¡¬ç¼–ç 
```

#### ä¿®å¤æ–¹æ¡ˆ

**æ–¹æ¡ˆ A: ä»é…ç½®æ–‡ä»¶è¯»å–ï¼ˆæ¨èï¼‰**

1. åˆ›å»º `dashboard-test-8831/config.js`:
```javascript
// é…ç½®æ–‡ä»¶
window.TASKFLOW_CONFIG = {
    // APIåŸºç¡€åœ°å€
    apiBaseUrl: (() => {
        // 1. å°è¯•ä»æœ¬åœ°å­˜å‚¨è¯»å–
        const saved = localStorage.getItem('taskflow_api_url');
        if (saved) return saved;

        // 2. ä»å½“å‰URLæ¨æ–­
        const port = window.location.port;
        if (port) {
            // Dashboardåœ¨8831ï¼ŒAPIåœ¨8800
            const apiPort = parseInt(port) - 31;
            return `${window.location.protocol}//${window.location.hostname}:${apiPort}`;
        }

        // 3. é»˜è®¤å€¼
        return 'http://localhost:8800';
    })(),

    // å…¶ä»–é…ç½®
    dashboardPort: window.location.port || 8831,
    projectId: localStorage.getItem('taskflow_project_id') || 'TASKFLOW'
};

console.log('ğŸ“ ä»»åŠ¡æ‰€é…ç½®:', window.TASKFLOW_CONFIG);
```

2. ä¿®æ”¹ `index.html` å¼•å…¥é…ç½®:
```html
<head>
    ...
    <!-- é…ç½®æ–‡ä»¶ -->
    <script src="config.js"></script>
</head>
```

3. ä¿®æ”¹æ‰€æœ‰APIè°ƒç”¨:
```javascript
// âœ… ä½¿ç”¨é…ç½®
const response = await fetch(`${window.TASKFLOW_CONFIG.apiBaseUrl}/api/engineer/events`);
```

**æ–¹æ¡ˆ B: å¯åŠ¨æ—¶æ³¨å…¥é…ç½®ï¼ˆæ›´çµæ´»ï¼‰**

1. ä¿®æ”¹å¯åŠ¨è„šæœ¬ç”Ÿæˆé…ç½®:
```bash
# åœ¨ å¯åŠ¨Dashboard.sh ä¸­ç”Ÿæˆ config.js
cat > "$PROJECT_DIR/dashboard-test-8831/config.js" << CONFIG
window.TASKFLOW_CONFIG = {
    apiBaseUrl: 'http://localhost:$API_PORT',
    dashboardPort: $PORT,
    projectId: '$PROJECT_ID',
    projectCode: '$PROJECT_CODE'
};
CONFIG
```

2. åœ¨ index.html ä¸­ä½¿ç”¨é…ç½®ï¼ˆåŒæ–¹æ¡ˆAï¼‰

#### ä¿®å¤æ­¥éª¤
1. åˆ›å»º `config.js` æ¨¡æ¿
2. ä¿®æ”¹å¯åŠ¨è„šæœ¬ç”Ÿæˆé…ç½®æ–‡ä»¶
3. å…¨å±€æœç´¢æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç çš„APIåœ°å€
4. æµ‹è¯•å„ä¸ªåŠŸèƒ½æ¨¡å—

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ä¼˜åŒ–ï¼ˆå»ºè®®å®Œæˆï¼‰

### ä¼˜åŒ– 1: æ·»åŠ  .env.example æ–‡ä»¶

#### åˆ›å»ºæ–‡ä»¶
`/.env.example`:
```bash
# ============================================
# ä»»åŠ¡æ‰€ 3.0 ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
# ä½¿ç”¨: cp .env.example .env
# ============================================

# ============================================
# MCP è®°å¿†ç³»ç»Ÿé…ç½®
# ============================================

# Session Memory API åœ°å€
# é»˜è®¤: http://localhost:4000
SESSION_MEMORY_API_URL=http://localhost:4000

# Ultra Memory Cloud MCP è„šæœ¬è·¯å¾„
# é»˜è®¤: ~/.taskflow/mcp/ultra-memory-cloud-mcp/src/server.js
ULTRA_MEMORY_SCRIPT=/path/to/ultra-memory-cloud-mcp/src/server.js

# Session Memory MCP è„šæœ¬è·¯å¾„
# é»˜è®¤: ~/.taskflow/mcp/session-memory-mcp/src/index.js
SESSION_MEMORY_SCRIPT=/path/to/session-memory-mcp/src/index.js

# MCP ç”¨æˆ·ID
# é»˜è®¤: taskflow
MCP_USER_ID=taskflow

# MCP å¹³å°æ ‡è¯†
# é»˜è®¤: taskflow-system
MCP_PLATFORM=taskflow-system

# ============================================
# AWS é…ç½®ï¼ˆUltra Memory ä½¿ç”¨ï¼‰
# ============================================

# AWS è®¿é—®å¯†é’¥ï¼ˆä» AWS Console è·å–ï¼‰
AWS_ACCESS_KEY_ID=your_access_key_here

# AWS å¯†é’¥ï¼ˆä» AWS Console è·å–ï¼‰
AWS_SECRET_ACCESS_KEY=your_secret_key_here

# AWS åŒºåŸŸ
# é»˜è®¤: us-east-1
AWS_REGION=us-east-1

# DynamoDB è¡¨å
DYNAMODB_WORKING_TABLE=ultra-memory-dev-working-memory
DYNAMODB_SEMANTIC_TABLE=ultra-memory-dev-memory-metadata
DYNAMODB_RELATIONS_TABLE=ultra-memory-dev-relational-memory

# ============================================
# æœåŠ¡ç«¯å£é…ç½®
# ============================================

# API æœåŠ¡ç«¯å£ï¼ˆè‡ªåŠ¨åˆ†é…æˆ–æ‰‹åŠ¨æŒ‡å®šï¼‰
# é»˜è®¤: 8800
API_PORT=8800

# Dashboard ç«¯å£ï¼ˆè‡ªåŠ¨åˆ†é…æˆ–æ‰‹åŠ¨æŒ‡å®šï¼‰
# é»˜è®¤: 8831
DASHBOARD_PORT=8831

# ============================================
# é¡¹ç›®é…ç½®
# ============================================

# é¡¹ç›®åç§°ï¼ˆåˆå§‹åŒ–æ—¶è‡ªåŠ¨è®¾ç½®ï¼‰
PROJECT_NAME=My Awesome Project

# é¡¹ç›®ä»£ç ï¼ˆåˆå§‹åŒ–æ—¶è‡ªåŠ¨è®¾ç½®ï¼‰
PROJECT_CODE=MY_PROJECT

# é¡¹ç›®IDï¼ˆåˆå§‹åŒ–æ—¶è‡ªåŠ¨ç”ŸæˆUUIDï¼‰
PROJECT_ID=

# ============================================
# æ•°æ®åº“é…ç½®
# ============================================

# çŸ¥è¯†åº“æ•°æ®åº“è·¯å¾„
# é»˜è®¤: ./.taskflow/knowledge.db
DATABASE_PATH=./.taskflow/knowledge.db

# ============================================
# æ—¥å¿—é…ç½®
# ============================================

# æ—¥å¿—çº§åˆ«: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# æ—¥å¿—ç›®å½•
LOG_DIR=./.taskflow/logs
```

---

### ä¼˜åŒ– 2: æ·»åŠ é…ç½®æ£€æŸ¥è„šæœ¬

#### åˆ›å»ºæ–‡ä»¶
`/scripts/check_config.sh`:
```bash
#!/bin/bash
# ä»»åŠ¡æ‰€ 3.0 é…ç½®æ£€æŸ¥è„šæœ¬

echo "======================================"
echo "ğŸ” ä»»åŠ¡æ‰€ 3.0 é…ç½®æ£€æŸ¥"
echo "======================================"
echo ""

# é¢œè‰²å®šä¹‰
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# æ£€æŸ¥è®¡æ•°
ERRORS=0
WARNINGS=0

# ============================================
# æ£€æŸ¥ .env æ–‡ä»¶
# ============================================
echo "ğŸ“‹ æ£€æŸ¥ç¯å¢ƒå˜é‡æ–‡ä»¶..."
if [ -f ".env" ]; then
    echo -e "${GREEN}âœ“${NC} .env æ–‡ä»¶å­˜åœ¨"
else
    echo -e "${YELLOW}âš ${NC} .env æ–‡ä»¶ä¸å­˜åœ¨ï¼ˆå°†ä½¿ç”¨é»˜è®¤é…ç½®ï¼‰"
    echo "  å»ºè®®: cp .env.example .env"
    WARNINGS=$((WARNINGS + 1))
fi
echo ""

# ============================================
# æ£€æŸ¥ MCP é…ç½®
# ============================================
echo "ğŸ§  æ£€æŸ¥ MCP è®°å¿†ç³»ç»Ÿé…ç½®..."

# æ£€æŸ¥ Session Memory API
if [ -n "$SESSION_MEMORY_API_URL" ]; then
    echo -e "${GREEN}âœ“${NC} SESSION_MEMORY_API_URL: $SESSION_MEMORY_API_URL"
else
    echo -e "${YELLOW}âš ${NC} SESSION_MEMORY_API_URL æœªè®¾ç½®ï¼ˆå°†ä½¿ç”¨é»˜è®¤: http://localhost:4000ï¼‰"
    WARNINGS=$((WARNINGS + 1))
fi

# æ£€æŸ¥ MCP è„šæœ¬è·¯å¾„
if [ -n "$ULTRA_MEMORY_SCRIPT" ]; then
    if [ -f "$ULTRA_MEMORY_SCRIPT" ]; then
        echo -e "${GREEN}âœ“${NC} Ultra Memory MCP è„šæœ¬: $ULTRA_MEMORY_SCRIPT"
    else
        echo -e "${RED}âœ—${NC} Ultra Memory MCP è„šæœ¬ä¸å­˜åœ¨: $ULTRA_MEMORY_SCRIPT"
        ERRORS=$((ERRORS + 1))
    fi
else
    echo -e "${YELLOW}âš ${NC} ULTRA_MEMORY_SCRIPT æœªè®¾ç½®ï¼ˆå°†å°è¯•è‡ªåŠ¨æŸ¥æ‰¾ï¼‰"
    WARNINGS=$((WARNINGS + 1))
fi

if [ -n "$SESSION_MEMORY_SCRIPT" ]; then
    if [ -f "$SESSION_MEMORY_SCRIPT" ]; then
        echo -e "${GREEN}âœ“${NC} Session Memory MCP è„šæœ¬: $SESSION_MEMORY_SCRIPT"
    else
        echo -e "${RED}âœ—${NC} Session Memory MCP è„šæœ¬ä¸å­˜åœ¨: $SESSION_MEMORY_SCRIPT"
        ERRORS=$((ERRORS + 1))
    fi
else
    echo -e "${YELLOW}âš ${NC} SESSION_MEMORY_SCRIPT æœªè®¾ç½®ï¼ˆå°†å°è¯•è‡ªåŠ¨æŸ¥æ‰¾ï¼‰"
    WARNINGS=$((WARNINGS + 1))
fi
echo ""

# ============================================
# æ£€æŸ¥ AWS é…ç½®
# ============================================
echo "â˜ï¸  æ£€æŸ¥ AWS é…ç½®..."
if [ -n "$AWS_ACCESS_KEY_ID" ] && [ -n "$AWS_SECRET_ACCESS_KEY" ]; then
    echo -e "${GREEN}âœ“${NC} AWS å‡­è¯å·²é…ç½®"
else
    echo -e "${YELLOW}âš ${NC} AWS å‡­è¯æœªé…ç½®ï¼ˆUltra Memory åŠŸèƒ½å°†å—é™ï¼‰"
    echo "  å»ºè®®: åœ¨ .env ä¸­é…ç½® AWS_ACCESS_KEY_ID å’Œ AWS_SECRET_ACCESS_KEY"
    WARNINGS=$((WARNINGS + 1))
fi
echo ""

# ============================================
# æ£€æŸ¥ç«¯å£
# ============================================
echo "ğŸ”Œ æ£€æŸ¥ç«¯å£é…ç½®..."
if [ -n "$API_PORT" ]; then
    echo -e "${GREEN}âœ“${NC} API_PORT: $API_PORT"
else
    echo -e "${YELLOW}âš ${NC} API_PORT æœªè®¾ç½®ï¼ˆå°†ä½¿ç”¨é»˜è®¤: 8800ï¼‰"
fi

if [ -n "$DASHBOARD_PORT" ]; then
    echo -e "${GREEN}âœ“${NC} DASHBOARD_PORT: $DASHBOARD_PORT"
else
    echo -e "${YELLOW}âš ${NC} DASHBOARD_PORT æœªè®¾ç½®ï¼ˆå°†ä½¿ç”¨è‡ªåŠ¨åˆ†é…ï¼‰"
fi
echo ""

# ============================================
# æ£€æŸ¥æ•°æ®åº“
# ============================================
echo "ğŸ—„ï¸  æ£€æŸ¥æ•°æ®åº“..."
if [ -f ".taskflow/knowledge.db" ]; then
    echo -e "${GREEN}âœ“${NC} çŸ¥è¯†åº“æ•°æ®åº“å­˜åœ¨: .taskflow/knowledge.db"
else
    echo -e "${YELLOW}âš ${NC} çŸ¥è¯†åº“æ•°æ®åº“ä¸å­˜åœ¨ï¼ˆé¦–æ¬¡å¯åŠ¨æ—¶å°†è‡ªåŠ¨åˆ›å»ºï¼‰"
fi
echo ""

# ============================================
# æ€»ç»“
# ============================================
echo "======================================"
echo "ğŸ“Š æ£€æŸ¥ç»“æœ"
echo "======================================"
if [ $ERRORS -eq 0 ] && [ $WARNINGS -eq 0 ]; then
    echo -e "${GREEN}âœ… æ‰€æœ‰é…ç½®æ­£å¸¸${NC}"
    exit 0
elif [ $ERRORS -eq 0 ]; then
    echo -e "${YELLOW}âš ï¸  å‘ç° $WARNINGS ä¸ªè­¦å‘Šï¼ˆå¯å¿½ç•¥ï¼‰${NC}"
    exit 0
else
    echo -e "${RED}âŒ å‘ç° $ERRORS ä¸ªé”™è¯¯${NC}"
    echo -e "${YELLOW}âš ï¸  å‘ç° $WARNINGS ä¸ªè­¦å‘Š${NC}"
    echo ""
    echo "è¯·ä¿®å¤é”™è¯¯åé‡è¯•"
    exit 1
fi
```

---

### ä¼˜åŒ– 3: ä¼˜åŒ–å¯åŠ¨è„šæœ¬

#### ä¿®æ”¹ `.taskflow/å¯åŠ¨Dashboard.sh`
```bash
#!/bin/bash
# ä»»åŠ¡æ‰€ Dashboard å¯åŠ¨è„šæœ¬ - ä¼˜åŒ–ç‰ˆ

TASKFLOW_DIR="$TASKFLOW_DIR"
PROJECT_DIR="$PROJECT_DIR"

# ä»é…ç½®æ–‡ä»¶è¯»å–ç«¯å£
PORT=$(cat "$PROJECT_DIR/.taskflow/dashboard_port" 2>/dev/null || echo "8831")
API_PORT=$(cat "$PROJECT_DIR/.taskflow/api_port" 2>/dev/null || echo "8800")

echo "========================================"
echo "ğŸš€ å¯åŠ¨ä»»åŠ¡æ‰€ Dashboard"
echo "========================================"
echo ""
echo "é¡¹ç›®: $PROJECT_NAME"
echo "Dashboard: http://localhost:$PORT"
echo "API: http://localhost:$API_PORT"
echo ""

# ============================================
# ç”Ÿæˆå‰ç«¯é…ç½®æ–‡ä»¶
# ============================================
echo "ğŸ“ ç”Ÿæˆå‰ç«¯é…ç½®..."
cat > "$PROJECT_DIR/dashboard-test-8831/config.js" << JSCONFIG
// ä»»åŠ¡æ‰€é…ç½®æ–‡ä»¶ - è‡ªåŠ¨ç”Ÿæˆ
window.TASKFLOW_CONFIG = {
    apiBaseUrl: 'http://localhost:$API_PORT',
    dashboardPort: $PORT,
    projectId: '$(cat "$PROJECT_DIR/.taskflow/project_id.txt")',
    projectCode: '$(cat "$PROJECT_DIR/.taskflow/project_code.txt")',
    projectName: '$PROJECT_NAME',
    generatedAt: '$(date -Iseconds)'
};
console.log('ğŸ“ ä»»åŠ¡æ‰€é…ç½®å·²åŠ è½½:', window.TASKFLOW_CONFIG);
JSCONFIG

echo "âœ… é…ç½®æ–‡ä»¶å·²ç”Ÿæˆ: dashboard-test-8831/config.js"
echo ""

# ============================================
# å¯åŠ¨ API æœåŠ¡
# ============================================
echo "ğŸš€ å¯åŠ¨ API æœåŠ¡..."
cd "$TASKFLOW_DIR" && \
  python3 start_insight_api.py --port $API_PORT > "$PROJECT_DIR/.taskflow/logs/api.log" 2>&1 &
API_PID=$!
echo "$API_PID" > "$PROJECT_DIR/.taskflow/api.pid"
echo "âœ… APIæœåŠ¡å¯åŠ¨ (PID: $API_PID)"
echo "   æ—¥å¿—: .taskflow/logs/api.log"
echo ""

sleep 2

# æ£€æŸ¥APIæ˜¯å¦å¯åŠ¨æˆåŠŸ
if ! ps -p $API_PID > /dev/null; then
    echo "âŒ APIæœåŠ¡å¯åŠ¨å¤±è´¥"
    echo "è¯·æŸ¥çœ‹æ—¥å¿—: .taskflow/logs/api.log"
    exit 1
fi

# ============================================
# å¯åŠ¨ Dashboard
# ============================================
echo "ğŸŒ å¯åŠ¨ Dashboard..."
echo ""
echo "âœ… è®¿é—®åœ°å€: http://localhost:$PORT"
echo "ğŸ“Š é¡¹ç›®çœ‹æ¿: http://localhost:$PORT/#architect"
echo "ğŸ”§ å·¥ç¨‹å¸ˆå°: http://localhost:$PORT/#engineer"
echo ""
echo "æŒ‰ Ctrl+C åœæ­¢æœåŠ¡"
echo ""

# å°è¯•è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
if command -v xdg-open > /dev/null; then
    xdg-open "http://localhost:$PORT" 2>/dev/null &
elif command -v open > /dev/null; then
    open "http://localhost:$PORT" 2>/dev/null &
fi

cd "$TASKFLOW_DIR/dashboard-test-8831" && \
  python3 -m http.server $PORT

# ============================================
# æ¸…ç†
# ============================================
echo ""
echo "ğŸ›‘ æ­£åœ¨åœæ­¢æœåŠ¡..."
kill $API_PID 2>/dev/null
rm "$PROJECT_DIR/.taskflow/api.pid" 2>/dev/null
echo "âœ… æœåŠ¡å·²åœæ­¢"
```

---

## ğŸŸ¢ ä½ä¼˜å…ˆçº§ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

### ä¼˜åŒ– 4: æ·»åŠ ç¯å¢ƒå˜é‡è®¾ç½®æŒ‡å—

#### åˆ›å»ºæ–‡ä»¶
`/docs/ENV_SETUP_GUIDE.md`:
```markdown
# ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®æŒ‡å—

## å¿«é€Ÿå¼€å§‹

1. å¤åˆ¶æ¨¡æ¿:
   ```bash
   cp .env.example .env
   ```

2. ç¼–è¾‘é…ç½®:
   ```bash
   vi .env
   # æˆ–ä½¿ç”¨ä½ å–œæ¬¢çš„ç¼–è¾‘å™¨
   ```

3. æ£€æŸ¥é…ç½®:
   ```bash
   ./scripts/check_config.sh
   ```

## MCP å·¥å…·å®‰è£…

### Session Memory MCP

1. å®‰è£…:
   ```bash
   git clone https://github.com/your-org/session-memory-mcp.git ~/.taskflow/mcp/session-memory-mcp
   cd ~/.taskflow/mcp/session-memory-mcp
   npm install
   ```

2. é…ç½® .env:
   ```bash
   SESSION_MEMORY_SCRIPT=~/.taskflow/mcp/session-memory-mcp/src/index.js
   SESSION_MEMORY_API_URL=http://localhost:4000
   ```

### Ultra Memory Cloud MCP

1. å®‰è£…:
   ```bash
   git clone https://github.com/your-org/ultra-memory-cloud-mcp.git ~/.taskflow/mcp/ultra-memory-cloud-mcp
   cd ~/.taskflow/mcp/ultra-memory-cloud-mcp
   npm install
   ```

2. è·å– AWS å‡­è¯:
   - ç™»å½• AWS Console
   - åˆ›å»º IAM ç”¨æˆ·
   - ç”Ÿæˆè®¿é—®å¯†é’¥

3. é…ç½® .env:
   ```bash
   ULTRA_MEMORY_SCRIPT=~/.taskflow/mcp/ultra-memory-cloud-mcp/src/server.js
   AWS_ACCESS_KEY_ID=your_key_here
   AWS_SECRET_ACCESS_KEY=your_secret_here
   ```

## ç”Ÿäº§ç¯å¢ƒé…ç½®

### ä½¿ç”¨è‡ªå®šä¹‰åŸŸå

ä¿®æ”¹ .env:
```bash
API_BASE_URL=https://api.yourdomain.com
DASHBOARD_URL=https://dashboard.yourdomain.com
```

### ä½¿ç”¨åå‘ä»£ç†

Nginx é…ç½®ç¤ºä¾‹:
```nginx
server {
    listen 80;
    server_name taskflow.yourdomain.com;

    location /api/ {
        proxy_pass http://localhost:8800/;
    }

    location / {
        proxy_pass http://localhost:8831/;
    }
}
```
```

---

## ğŸ“‹ å®æ–½æ¸…å•

### é˜¶æ®µ 1: æ ¸å¿ƒä¿®å¤ï¼ˆ2å°æ—¶ï¼‰

- [ ] ä¿®å¤ `mcp_memory_client.py` ä¸­çš„ç¡¬ç¼–ç 
  - [ ] æ·»åŠ ç¯å¢ƒå˜é‡æ”¯æŒ
  - [ ] å®ç°MCPè„šæœ¬è‡ªåŠ¨æŸ¥æ‰¾
  - [ ] æ·»åŠ é™çº§å¤„ç†

- [ ] ä¿®å¤å‰ç«¯APIåœ°å€ç¡¬ç¼–ç 
  - [ ] åˆ›å»º `config.js` æ¨¡æ¿
  - [ ] æ›¿æ¢æ‰€æœ‰ç¡¬ç¼–ç åœ°å€
  - [ ] æµ‹è¯•å„åŠŸèƒ½æ¨¡å—

- [ ] ä¿®å¤åˆå§‹åŒ–è„šæœ¬
  - [ ] ç”Ÿæˆ `config.js`
  - [ ] æ›´æ–°READMEè¯´æ˜

### é˜¶æ®µ 2: é…ç½®å®Œå–„ï¼ˆ1å°æ—¶ï¼‰

- [ ] åˆ›å»º `.env.example`
- [ ] åˆ›å»ºé…ç½®æ£€æŸ¥è„šæœ¬
- [ ] ä¼˜åŒ–å¯åŠ¨è„šæœ¬
- [ ] æµ‹è¯•å®Œæ•´æµç¨‹

### é˜¶æ®µ 3: æ–‡æ¡£è¡¥å……ï¼ˆ1å°æ—¶ï¼‰

- [ ] ç¯å¢ƒå˜é‡è®¾ç½®æŒ‡å—
- [ ] æ•…éšœæ’é™¤æ–‡æ¡£
- [ ] ç”Ÿäº§éƒ¨ç½²æŒ‡å—
- [ ] æ›´æ–°ä¸»README

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•åœºæ™¯ 1: å…¨æ–°é¡¹ç›®åˆå§‹åŒ–
```bash
# 1. è§£å‹ä»»åŠ¡æ‰€
tar -xzf ä»»åŠ¡æ‰€3.0-Blanc-Luxury-Edition-20251128.tar.gz

# 2. åˆå§‹åŒ–é¡¹ç›®
cd /tmp/test-project
cp -r ~/taskflow-3.0 ./taskflow
./taskflow/ğŸš€å³æ’å³ç”¨-åˆå§‹åŒ–é¡¹ç›®.sh

# 3. å¯åŠ¨
./.taskflow/å¯åŠ¨Dashboard.sh

# éªŒè¯:
# - âœ… æ— éœ€æ‰‹åŠ¨é…ç½®
# - âœ… è‡ªåŠ¨åˆ†é…ç«¯å£
# - âœ… Dashboardæ­£å¸¸è®¿é—®
# - âœ… APIåŠŸèƒ½æ­£å¸¸
```

### æµ‹è¯•åœºæ™¯ 2: é…ç½®MCPå·¥å…·
```bash
# 1. å®‰è£…MCPå·¥å…·
git clone ... ~/.taskflow/mcp/session-memory-mcp
git clone ... ~/.taskflow/mcp/ultra-memory-cloud-mcp

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
vi .env  # å¡«å†™AWSå‡­è¯

# 3. æ£€æŸ¥é…ç½®
./scripts/check_config.sh

# 4. å¯åŠ¨
./.taskflow/å¯åŠ¨Dashboard.sh

# éªŒè¯:
# - âœ… è‡ªåŠ¨æ‰¾åˆ°MCPè„šæœ¬
# - âœ… è®°å¿†åŠŸèƒ½æ­£å¸¸
# - âœ… æ— è­¦å‘Šæˆ–é”™è¯¯
```

### æµ‹è¯•åœºæ™¯ 3: å¤šé¡¹ç›®å¹¶è¡Œ
```bash
# 1. åˆå§‹åŒ–é¡¹ç›®A
cd ~/project-a
./taskflow/ğŸš€å³æ’å³ç”¨-åˆå§‹åŒ–é¡¹ç›®.sh
./.taskflow/å¯åŠ¨Dashboard.sh  # ç«¯å£ 8841/8842

# 2. åˆå§‹åŒ–é¡¹ç›®B
cd ~/project-b
./taskflow/ğŸš€å³æ’å³ç”¨-åˆå§‹åŒ–é¡¹ç›®.sh
./.taskflow/å¯åŠ¨Dashboard.sh  # ç«¯å£ 8843/8844

# éªŒè¯:
# - âœ… ç«¯å£è‡ªåŠ¨é¿å¼€å†²çª
# - âœ… ä¸¤ä¸ªé¡¹ç›®ç‹¬ç«‹è¿è¡Œ
# - âœ… æ•°æ®äº’ä¸å¹²æ‰°
```

---

## ğŸ“Š é¢„æœŸæˆæœ

å®Œæˆä¼˜åŒ–å:

### ç”¨æˆ·ä½“éªŒæå‡
- âœ… é›¶é…ç½®å¯åŠ¨ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰
- âœ… è‡ªåŠ¨æ£€æµ‹å’Œé€‚é…ç¯å¢ƒ
- âœ… æ¸…æ™°çš„é…ç½®æŒ‡å¯¼ï¼ˆéœ€è¦æ—¶ï¼‰
- âœ… å‹å¥½çš„é”™è¯¯æç¤º

### é…ç½®çµæ´»æ€§
- âœ… æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–æ‰€æœ‰é…ç½®
- âœ… æ”¯æŒé…ç½®æ–‡ä»¶
- âœ… æ”¯æŒå‘½ä»¤è¡Œå‚æ•°
- âœ… åˆç†çš„é»˜è®¤å€¼

### éƒ¨ç½²é€‚åº”æ€§
- âœ… å¼€å‘ç¯å¢ƒå³æ’å³ç”¨
- âœ… ç”Ÿäº§ç¯å¢ƒå¯çµæ´»é…ç½®
- âœ… æ”¯æŒDockerå®¹å™¨åŒ–
- âœ… æ”¯æŒäº‘å¹³å°éƒ¨ç½²

---

**æ–¹æ¡ˆåˆ›å»º**: 2025-11-28
**é¢„è®¡å®Œæˆ**: 2025-11-29
**è´Ÿè´£äºº**: å¾…åˆ†é…
